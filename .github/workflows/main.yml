name : appollo ci

#Controls when the workflow will run (merge on main and pull request on main)
# on:
#   push:
#     branches: [ "main" ]
#   pull_request:
#     branches: [ "main" ]

on: ['push']

jobs:
  #name of job
  check_validity_flutter:
    # chose the runner (personal runner in this case)
    runs-on: [runner_nathan_label]

    #name of this workflow
    name: "Test phase" 
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Run unite test
        run: echo 'test flutter'
        # run: flutter test


  build_ipa:
    runs-on: [runner_nathan_label]
    name: "Build IPA file" 
    steps:
      - name: Connection
        run : echo "Connection step"
        # run : appollo signin --email <email> --password <password>

      - name: Building the IPA
        run: echo 'build ipa'
        # run: appollo build start --build-type=ad-hoc 882
        # run: appollo build start --build-type=ad-hoc <application_key>

      - name: Disconnection
        run : echo "Disconnection step"
        # run : appollo signout


  deploy:
    runs-on: [runner_nathan_label]
    name: "Publish app" 
    steps:
      - name: Connection
        if: github.ref == 'refs/heads/dev'
        run : echo "on publie"

